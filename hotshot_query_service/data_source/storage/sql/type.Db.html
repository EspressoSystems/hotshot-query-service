<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="The underlying database type for a SQL data source."><title>Db in hotshot_query_service::data_source::storage::sql - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-46f98efaafac5295.ttf.woff2,FiraSans-Regular-018c141bf0843ffd.woff2,FiraSans-Medium-8f9a781e4970d388.woff2,SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2,SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../../../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../../../static.files/rustdoc-b0742ba02757f159.css"><meta name="rustdoc-vars" data-root-path="../../../../" data-static-root-path="../../../../static.files/" data-current-crate="hotshot_query_service" data-themes="" data-resource-suffix="" data-rustdoc-version="1.83.0 (90b35a623 2024-11-26)" data-channel="1.83.0" data-search-js="search-f0d225181b97f9a4.js" data-settings-js="settings-805db61a62df4bd2.js" ><script src="../../../../static.files/storage-1d39b6787ed640ff.js"></script><script defer src="sidebar-items.js"></script><script defer src="../../../../static.files/main-f070b9041d14864c.js"></script><noscript><link rel="stylesheet" href="../../../../static.files/noscript-0111fcff984fae8f.css"></noscript><link rel="alternate icon" type="image/png" href="../../../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc type"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../../../../hotshot_query_service/index.html">hotshot_<wbr>query_<wbr>service</a><span class="version">0.1.76</span></h2></div><div class="sidebar-elems"><section id="rustdoc-toc"><h2 class="location"><a href="#">Db</a></h2><h3><a href="#">Sections</a></h3><ul class="block top-toc"><li><a href="#design-choice" title="Design Choice">Design Choice</a></li></ul><h3><a href="#aliased-type">Aliased type</a></h3></section><div id="rustdoc-modnav"><h2><a href="index.html">In hotshot_<wbr>query_<wbr>service::<wbr>data_<wbr>source::<wbr>storage::<wbr>sql</a></h2></div></div></nav><div class="sidebar-resizer"></div><main><div class="width-limiter"><rustdoc-search></rustdoc-search><section id="main-content" class="content"><div class="main-heading"><span class="rustdoc-breadcrumbs"><a href="../../../index.html">hotshot_query_service</a>::<wbr><a href="../../index.html">data_source</a>::<wbr><a href="../index.html">storage</a>::<wbr><a href="index.html">sql</a></span><h1>Type Alias <span class="type">Db</span><button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><rustdoc-toolbar></rustdoc-toolbar><span class="sub-heading"><a class="src" href="../../../../src/hotshot_query_service/data_source/storage/sql/db.rs.html#41">source</a> </span></div><pre class="rust item-decl"><code>pub type Db = <a class="struct" href="struct.Sqlite.html" title="struct hotshot_query_service::data_source::storage::sql::Sqlite">Sqlite</a>;</code></pre><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>The underlying database type for a SQL data source.</p>
<p>Currently, only PostgreSQL and SQLite are supported, with selection based on the “embedded-db” feature flag.</p>
<ul>
<li>When the “embedded-db” feature is enabled, SQLite is used.</li>
<li>When it’s disabled, PostgreSQL is used.</li>
</ul>
<h4 id="design-choice"><a class="doc-anchor" href="#design-choice">§</a>Design Choice</h4>
<p>The reason for taking this approach over sqlx’s Any database is that we can support SQL types
which are implemented for the two backends we care about (Postgres and SQLite) but not for <em>any</em>
SQL database, such as MySQL. Crucially, JSON types fall in this category.</p>
<p>The reason for taking this approach rather than writing all of our code to be generic over the
Database implementation is that sqlx does not have the necessary trait bounds on all of the
associated types (e.g. Database::Connection does not implement Executor for all possible
databases, the Executor impl lives on each concrete connection type) and Rust does not provide
a good way of encapsulating a collection of trait bounds on associated types. Thus, our function
signatures become untenably messy with bounds like</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">fn </span>foo&lt;DB: Database&gt;()
<span class="kw">where
    for</span>&lt;<span class="lifetime">'a</span>&gt; <span class="kw-2">&amp;</span><span class="lifetime">'a </span><span class="kw-2">mut </span>DB::Connection: Executor&lt;<span class="lifetime">'a</span>&gt;,
    <span class="kw">for</span>&lt;<span class="lifetime">'q</span>&gt; DB::Arguments&lt;<span class="lifetime">'q</span>&gt;: IntoArguments&lt;<span class="lifetime">'q</span>, DB&gt;,
    <span class="kw">for</span>&lt;<span class="lifetime">'a</span>&gt; i64: Type&lt;DB&gt; + Encode&lt;<span class="lifetime">'a</span>, DB&gt;,
{}</code></pre></div>
</div></details><h2 id="aliased-type" class="section-header">Aliased Type<a href="#aliased-type" class="anchor">§</a></h2><pre class="rust item-decl"><code>struct Db;</code></pre><script src="../../../../type.impl/hotshot_query_service/data_source/storage/sql/struct.Sqlite.js" data-self-path="hotshot_query_service::data_source::storage::sql::db::Db" async></script></section></div></main></body></html>