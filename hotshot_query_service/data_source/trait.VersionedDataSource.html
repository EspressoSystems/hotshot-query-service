<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="A data source with an atomic transaction-based synchronization interface."><title>VersionedDataSource in hotshot_query_service::data_source - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-46f98efaafac5295.ttf.woff2,FiraSans-Regular-018c141bf0843ffd.woff2,FiraSans-Medium-8f9a781e4970d388.woff2,SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2,SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../static.files/rustdoc-dd39b87e5fcfba68.css"><meta name="rustdoc-vars" data-root-path="../../" data-static-root-path="../../static.files/" data-current-crate="hotshot_query_service" data-themes="" data-resource-suffix="" data-rustdoc-version="1.80.0 (051478957 2024-07-21)" data-channel="1.80.0" data-search-js="search-d52510db62a78183.js" data-settings-js="settings-4313503d2e1961c2.js" ><script src="../../static.files/storage-118b08c4c78b968e.js"></script><script defer src="sidebar-items.js"></script><script defer src="../../static.files/main-20a3ad099b048cf2.js"></script><noscript><link rel="stylesheet" href="../../static.files/noscript-df360f571f6edeae.css"></noscript><link rel="alternate icon" type="image/png" href="../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc trait"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../../hotshot_query_service/index.html">hotshot_query_service</a><span class="version">0.1.49</span></h2></div><h2 class="location"><a href="#">VersionedDataSource</a></h2><div class="sidebar-elems"><section><h3><a href="#required-associated-types">Required Associated Types</a></h3><ul class="block"><li><a href="#associatedtype.Error">Error</a></li></ul><h3><a href="#required-methods">Required Methods</a></h3><ul class="block"><li><a href="#tymethod.commit">commit</a></li><li><a href="#tymethod.revert">revert</a></li></ul><h3><a href="#implementors">Implementors</a></h3></section><h2><a href="index.html">In hotshot_query_service::data_source</a></h2></div></nav><div class="sidebar-resizer"></div><main><div class="width-limiter"><rustdoc-search></rustdoc-search><section id="main-content" class="content"><div class="main-heading"><h1>Trait <a href="../index.html">hotshot_query_service</a>::<wbr><a href="index.html">data_source</a>::<wbr><a class="trait" href="#">VersionedDataSource</a><button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><span class="out-of-band"><a class="src" href="../../src/hotshot_query_service/data_source/update.rs.html#183-197">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><pre class="rust item-decl"><code>pub trait VersionedDataSource {
    type <a href="#associatedtype.Error" class="associatedtype">Error</a>: <a class="trait" href="https://doc.rust-lang.org/1.80.0/core/error/trait.Error.html" title="trait core::error::Error">Error</a> + <a class="trait" href="https://doc.rust-lang.org/1.80.0/core/fmt/trait.Debug.html" title="trait core::fmt::Debug">Debug</a> + <a class="trait" href="https://doc.rust-lang.org/1.80.0/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a> + <a class="trait" href="https://doc.rust-lang.org/1.80.0/core/marker/trait.Sync.html" title="trait core::marker::Sync">Sync</a> + 'static;

    // Required methods
    fn <a href="#tymethod.commit" class="fn">commit</a>&lt;'life0, 'async_trait&gt;(
        &amp;'life0 mut self,
    ) -&gt; <a class="struct" href="https://doc.rust-lang.org/1.80.0/core/pin/struct.Pin.html" title="struct core::pin::Pin">Pin</a>&lt;<a class="struct" href="https://doc.rust-lang.org/1.80.0/alloc/boxed/struct.Box.html" title="struct alloc::boxed::Box">Box</a>&lt;dyn <a class="trait" href="https://doc.rust-lang.org/1.80.0/core/future/future/trait.Future.html" title="trait core::future::future::Future">Future</a>&lt;Output = <a class="enum" href="https://doc.rust-lang.org/1.80.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.80.0/std/primitive.unit.html">()</a>, Self::<a class="associatedtype" href="trait.VersionedDataSource.html#associatedtype.Error" title="type hotshot_query_service::data_source::VersionedDataSource::Error">Error</a>&gt;&gt; + <a class="trait" href="https://doc.rust-lang.org/1.80.0/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a> + 'async_trait&gt;&gt;
       <span class="where">where Self: 'async_trait,
             'life0: 'async_trait</span>;
<span class="item-spacer"></span>    fn <a href="#tymethod.revert" class="fn">revert</a>&lt;'life0, 'async_trait&gt;(
        &amp;'life0 mut self,
    ) -&gt; <a class="struct" href="https://doc.rust-lang.org/1.80.0/core/pin/struct.Pin.html" title="struct core::pin::Pin">Pin</a>&lt;<a class="struct" href="https://doc.rust-lang.org/1.80.0/alloc/boxed/struct.Box.html" title="struct alloc::boxed::Box">Box</a>&lt;dyn <a class="trait" href="https://doc.rust-lang.org/1.80.0/core/future/future/trait.Future.html" title="trait core::future::future::Future">Future</a>&lt;Output = <a class="primitive" href="https://doc.rust-lang.org/1.80.0/std/primitive.unit.html">()</a>&gt; + <a class="trait" href="https://doc.rust-lang.org/1.80.0/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a> + 'async_trait&gt;&gt;
       <span class="where">where Self: 'async_trait,
             'life0: 'async_trait</span>;
}</code></pre><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>A data source with an atomic transaction-based synchronization interface.</p>
<p>Any changes made to a versioned data source are initially visible when queried through that same
data source object only. They are not immediately written back to storage, which means that a
new data source object opened against the same persistent storage will not reflect the changes.
In particular, this means that if the process restarts and reopens its storage, uncommitted
changes will be lost.</p>
<p>The methods provided by this trait can be used to write such pending changes back to persistent
storage (<a href="trait.VersionedDataSource.html#tymethod.commit">commit</a>) so that they become visible to other clients of the same
underlying storage, and are saved if the process restarts. It also allows pending changes to be
rolled back (<a href="trait.VersionedDataSource.html#tymethod.revert">revert</a>) so that they are never written back to storage and are no
longer reflected even through the data source object which was used to make the changes.</p>
</div></details><h2 id="required-associated-types" class="section-header">Required Associated Types<a href="#required-associated-types" class="anchor">§</a></h2><div class="methods"><section id="associatedtype.Error" class="method"><a class="src rightside" href="../../src/hotshot_query_service/data_source/update.rs.html#184">source</a><h4 class="code-header">type <a href="#associatedtype.Error" class="associatedtype">Error</a>: <a class="trait" href="https://doc.rust-lang.org/1.80.0/core/error/trait.Error.html" title="trait core::error::Error">Error</a> + <a class="trait" href="https://doc.rust-lang.org/1.80.0/core/fmt/trait.Debug.html" title="trait core::fmt::Debug">Debug</a> + <a class="trait" href="https://doc.rust-lang.org/1.80.0/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a> + <a class="trait" href="https://doc.rust-lang.org/1.80.0/core/marker/trait.Sync.html" title="trait core::marker::Sync">Sync</a> + 'static</h4></section></div><h2 id="required-methods" class="section-header">Required Methods<a href="#required-methods" class="anchor">§</a></h2><div class="methods"><details class="toggle method-toggle" open><summary><section id="tymethod.commit" class="method"><a class="src rightside" href="../../src/hotshot_query_service/data_source/update.rs.html#190">source</a><h4 class="code-header">fn <a href="#tymethod.commit" class="fn">commit</a>&lt;'life0, 'async_trait&gt;(
    &amp;'life0 mut self,
) -&gt; <a class="struct" href="https://doc.rust-lang.org/1.80.0/core/pin/struct.Pin.html" title="struct core::pin::Pin">Pin</a>&lt;<a class="struct" href="https://doc.rust-lang.org/1.80.0/alloc/boxed/struct.Box.html" title="struct alloc::boxed::Box">Box</a>&lt;dyn <a class="trait" href="https://doc.rust-lang.org/1.80.0/core/future/future/trait.Future.html" title="trait core::future::future::Future">Future</a>&lt;Output = <a class="enum" href="https://doc.rust-lang.org/1.80.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.80.0/std/primitive.unit.html">()</a>, Self::<a class="associatedtype" href="trait.VersionedDataSource.html#associatedtype.Error" title="type hotshot_query_service::data_source::VersionedDataSource::Error">Error</a>&gt;&gt; + <a class="trait" href="https://doc.rust-lang.org/1.80.0/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a> + 'async_trait&gt;&gt;<div class="where">where
    Self: 'async_trait,
    'life0: 'async_trait,</div></h4></section></summary><div class="docblock"><p>Atomically commit to all outstanding modifications to the data.</p>
<p>If this method fails, outstanding changes are left unmodified. The caller may opt to retry
or to erase outstanding changes with <a href="trait.VersionedDataSource.html#tymethod.revert"><code>revert</code></a>.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.revert" class="method"><a class="src rightside" href="../../src/hotshot_query_service/data_source/update.rs.html#196">source</a><h4 class="code-header">fn <a href="#tymethod.revert" class="fn">revert</a>&lt;'life0, 'async_trait&gt;(
    &amp;'life0 mut self,
) -&gt; <a class="struct" href="https://doc.rust-lang.org/1.80.0/core/pin/struct.Pin.html" title="struct core::pin::Pin">Pin</a>&lt;<a class="struct" href="https://doc.rust-lang.org/1.80.0/alloc/boxed/struct.Box.html" title="struct alloc::boxed::Box">Box</a>&lt;dyn <a class="trait" href="https://doc.rust-lang.org/1.80.0/core/future/future/trait.Future.html" title="trait core::future::future::Future">Future</a>&lt;Output = <a class="primitive" href="https://doc.rust-lang.org/1.80.0/std/primitive.unit.html">()</a>&gt; + <a class="trait" href="https://doc.rust-lang.org/1.80.0/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a> + 'async_trait&gt;&gt;<div class="where">where
    Self: 'async_trait,
    'life0: 'async_trait,</div></h4></section></summary><div class="docblock"><p>Erase all oustanding modifications to the data.</p>
<p>This function must not return if it has failed to revert changes. Inability to revert
changes to the database is considered a fatal error, and this function may panic.</p>
</div></details></div><h2 id="implementors" class="section-header">Implementors<a href="#implementors" class="anchor">§</a></h2><div id="implementors-list"><details class="toggle implementors-toggle"><summary><section id="impl-VersionedDataSource-for-DataSource" class="impl"><a class="src rightside" href="../../src/hotshot_query_service/data_source/storage/no_storage.rs.html#337-353">source</a><a href="#impl-VersionedDataSource-for-DataSource" class="anchor">§</a><h3 class="code-header">impl <a class="trait" href="trait.VersionedDataSource.html" title="trait hotshot_query_service::data_source::VersionedDataSource">VersionedDataSource</a> for <a class="enum" href="storage/no_storage/testing/enum.DataSource.html" title="enum hotshot_query_service::data_source::storage::no_storage::testing::DataSource">DataSource</a></h3></section></summary><div class="impl-items"><section id="associatedtype.Error-1" class="associatedtype trait-impl"><a href="#associatedtype.Error-1" class="anchor">§</a><h4 class="code-header">type <a href="#associatedtype.Error" class="associatedtype">Error</a> = <a class="enum" href="../enum.QueryError.html" title="enum hotshot_query_service::QueryError">QueryError</a></h4></section></div></details><details class="toggle implementors-toggle"><summary><section id="impl-VersionedDataSource-for-NoStorage" class="impl"><a class="src rightside" href="../../src/hotshot_query_service/data_source/storage/no_storage.rs.html#42-50">source</a><a href="#impl-VersionedDataSource-for-NoStorage" class="anchor">§</a><h3 class="code-header">impl <a class="trait" href="trait.VersionedDataSource.html" title="trait hotshot_query_service::data_source::VersionedDataSource">VersionedDataSource</a> for <a class="struct" href="storage/no_storage/struct.NoStorage.html" title="struct hotshot_query_service::data_source::storage::no_storage::NoStorage">NoStorage</a></h3></section></summary><div class="impl-items"><section id="associatedtype.Error-2" class="associatedtype trait-impl"><a href="#associatedtype.Error-2" class="anchor">§</a><h4 class="code-header">type <a href="#associatedtype.Error" class="associatedtype">Error</a> = <a class="enum" href="https://doc.rust-lang.org/1.80.0/core/convert/enum.Infallible.html" title="enum core::convert::Infallible">Infallible</a></h4></section></div></details><details class="toggle implementors-toggle"><summary><section id="impl-VersionedDataSource-for-SqlStorage" class="impl"><a class="src rightside" href="../../src/hotshot_query_service/data_source/storage/sql.rs.html#691-701">source</a><a href="#impl-VersionedDataSource-for-SqlStorage" class="anchor">§</a><h3 class="code-header">impl <a class="trait" href="trait.VersionedDataSource.html" title="trait hotshot_query_service::data_source::VersionedDataSource">VersionedDataSource</a> for <a class="struct" href="storage/sql/struct.SqlStorage.html" title="struct hotshot_query_service::data_source::storage::sql::SqlStorage">SqlStorage</a></h3></section></summary><div class="impl-items"><section id="associatedtype.Error-3" class="associatedtype trait-impl"><a href="#associatedtype.Error-3" class="anchor">§</a><h4 class="code-header">type <a href="#associatedtype.Error" class="associatedtype">Error</a> = <a class="enum" href="../enum.QueryError.html" title="enum hotshot_query_service::QueryError">QueryError</a></h4></section></div></details><details class="toggle implementors-toggle"><summary><section id="impl-VersionedDataSource-for-ExtensibleDataSource%3CD,+U%3E" class="impl"><a class="src rightside" href="../../src/hotshot_query_service/data_source/extension.rs.html#118-132">source</a><a href="#impl-VersionedDataSource-for-ExtensibleDataSource%3CD,+U%3E" class="anchor">§</a><h3 class="code-header">impl&lt;D, U&gt; <a class="trait" href="trait.VersionedDataSource.html" title="trait hotshot_query_service::data_source::VersionedDataSource">VersionedDataSource</a> for <a class="struct" href="struct.ExtensibleDataSource.html" title="struct hotshot_query_service::data_source::ExtensibleDataSource">ExtensibleDataSource</a>&lt;D, U&gt;<div class="where">where
    D: <a class="trait" href="trait.VersionedDataSource.html" title="trait hotshot_query_service::data_source::VersionedDataSource">VersionedDataSource</a> + <a class="trait" href="https://doc.rust-lang.org/1.80.0/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a>,
    U: <a class="trait" href="https://doc.rust-lang.org/1.80.0/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a>,</div></h3></section></summary><div class="impl-items"><section id="associatedtype.Error-4" class="associatedtype trait-impl"><a href="#associatedtype.Error-4" class="anchor">§</a><h4 class="code-header">type <a href="#associatedtype.Error" class="associatedtype">Error</a> = &lt;D as <a class="trait" href="trait.VersionedDataSource.html" title="trait hotshot_query_service::data_source::VersionedDataSource">VersionedDataSource</a>&gt;::<a class="associatedtype" href="trait.VersionedDataSource.html#associatedtype.Error" title="type hotshot_query_service::data_source::VersionedDataSource::Error">Error</a></h4></section></div></details><details class="toggle implementors-toggle"><summary><section id="impl-VersionedDataSource-for-FetchingDataSource%3CTypes,+S,+P%3E" class="impl"><a class="src rightside" href="../../src/hotshot_query_service/data_source/fetching.rs.html#760-775">source</a><a href="#impl-VersionedDataSource-for-FetchingDataSource%3CTypes,+S,+P%3E" class="anchor">§</a><h3 class="code-header">impl&lt;Types, S, P&gt; <a class="trait" href="trait.VersionedDataSource.html" title="trait hotshot_query_service::data_source::VersionedDataSource">VersionedDataSource</a> for <a class="struct" href="fetching/struct.FetchingDataSource.html" title="struct hotshot_query_service::data_source::fetching::FetchingDataSource">FetchingDataSource</a>&lt;Types, S, P&gt;<div class="where">where
    Types: NodeType,
    S: <a class="trait" href="trait.VersionedDataSource.html" title="trait hotshot_query_service::data_source::VersionedDataSource">VersionedDataSource</a> + <a class="trait" href="https://doc.rust-lang.org/1.80.0/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a> + <a class="trait" href="https://doc.rust-lang.org/1.80.0/core/marker/trait.Sync.html" title="trait core::marker::Sync">Sync</a>,
    P: <a class="trait" href="https://doc.rust-lang.org/1.80.0/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a> + <a class="trait" href="https://doc.rust-lang.org/1.80.0/core/marker/trait.Sync.html" title="trait core::marker::Sync">Sync</a>,</div></h3></section></summary><div class="impl-items"><section id="associatedtype.Error-5" class="associatedtype trait-impl"><a href="#associatedtype.Error-5" class="anchor">§</a><h4 class="code-header">type <a href="#associatedtype.Error" class="associatedtype">Error</a> = &lt;S as <a class="trait" href="trait.VersionedDataSource.html" title="trait hotshot_query_service::data_source::VersionedDataSource">VersionedDataSource</a>&gt;::<a class="associatedtype" href="trait.VersionedDataSource.html#associatedtype.Error" title="type hotshot_query_service::data_source::VersionedDataSource::Error">Error</a></h4></section></div></details><details class="toggle implementors-toggle"><summary><section id="impl-VersionedDataSource-for-FileSystemStorage%3CTypes%3E" class="impl"><a class="src rightside" href="../../src/hotshot_query_service/data_source/storage/fs.rs.html#239-260">source</a><a href="#impl-VersionedDataSource-for-FileSystemStorage%3CTypes%3E" class="anchor">§</a><h3 class="code-header">impl&lt;Types: NodeType&gt; <a class="trait" href="trait.VersionedDataSource.html" title="trait hotshot_query_service::data_source::VersionedDataSource">VersionedDataSource</a> for <a class="struct" href="storage/fs/struct.FileSystemStorage.html" title="struct hotshot_query_service::data_source::storage::fs::FileSystemStorage">FileSystemStorage</a>&lt;Types&gt;<div class="where">where
    <a class="type" href="../type.Payload.html" title="type hotshot_query_service::Payload">Payload</a>&lt;Types&gt;: <a class="trait" href="../availability/trait.QueryablePayload.html" title="trait hotshot_query_service::availability::QueryablePayload">QueryablePayload</a>&lt;Types&gt;,</div></h3></section></summary><div class="impl-items"><section id="associatedtype.Error-6" class="associatedtype trait-impl"><a href="#associatedtype.Error-6" class="anchor">§</a><h4 class="code-header">type <a href="#associatedtype.Error" class="associatedtype">Error</a> = PersistenceError</h4></section></div></details></div><script src="../../trait.impl/hotshot_query_service/data_source/update/trait.VersionedDataSource.js" async></script></section></div></main></body></html>